软件学报中国科学院软件研究所版权所有利用特征向量构造基于身份的全同态加密体制康元基顾纯祥郑永辉光焱信息工程大学河南郑州数学工程与先进计算国家重点实验室江苏无锡通讯作者顾纯祥摘要全同态加密可以在不解密的条件下对密文进行有效运算为云计算的数据隐私保护提供了一种理想的解决方案但目前已有的全同态加密体制普遍存在公钥尺寸大计算效率较低等问题利用构造特征向量的思想基于任意次数分圆环代数结构提出全同态加密体制并提出一种转换方法将该体制转换为基于身份的全同态加密体制与已有体制相比使用特征向量思想构造基于身份的体制有效地避免了计算密钥实现了真正意义上基于身份的体制相比次数为的方幂特殊分圆环使用任意次数分圆环最大会使加密体制的计算效率提升一倍同时还可应用单指令多数据简称技术进一步提升计算和存储效率关键词全同态加密特征向量基于身份加密任意分圆环中图法分类号中文引用格式康元基顾纯祥郑永辉光焱利用特征向量构造基于身份的全同态加密体制软件学报英文引用格式基金项目河南省科技创新杰出青年基金河南省基础与前沿技术研究数学工程与先进计算国家重点实验室开放基金收稿时间修改时间采用时间在线出版时间网络优先出版软件学报云计算是当前非常流行的新型技术代表着领域迅速向集约化专业化发展的趋势由于云计算的通用性及便利性它得到大力推动和发展但隐私保护问题与便利性的冲突已经成为制约云计算发展的重要因素即用户希望在享受云服务器便利性的同时也可以保护自己的隐私不外泄全同态加密体制允许服务器在不解密的条件下对数据进行有效运算因此它成为解决上述冲突的一个重要方案但已有的全同态加密体制普遍存在密文运算效率低公钥尺寸过大的问题如何有效管理密钥一直是体制应用面临的难题之一基于身份加密利用用户的唯一身份标识如电子邮箱地址等作为公钥用户私钥的生成由可信第三方来完成可信第三方由云服务器提供或用户自行选取具备不依赖公钥证书进行密钥管理的优点因此人们开始思考如何将基于身份加密的思想与全同态加密技术结合起来但是以往基于身份的全同态加密体制以下简称体制都必须借助运算密钥无法实现真正意义上的体制直到年等人舍弃了运算密钥利用特征向量方法构造了第一个真正意义上的体制这些体制大多以特殊分圆环作为基本代数结构虽然特殊分圆环结构简单使用方便但在构造体制时计算效率较低无法使用等技术因此本文提出了任意分圆环上的陷门借助该陷门和特征向量方法提出了体制相比提出的环上体制以下简称体制本文的体制最多可将密文运算效率提升一倍另外以任意分圆环作为基本代数结构还可应用技术使得每个密文可对应多份明文大大提升空间和计算效率本文第节介绍目前有关全同态加密的相关工作第节介绍本文体制所需的基础知识第节首先给出构造本文体制所需要的基本公钥体制再给出任意分圆环上特征向量体制并证明其正确性和安全性第节首先给出任意环上的陷门然后构造任意分圆环上使用特征向量的基于身份加密体制最后证明任意环上体制到体制的转换定理第节对以上内容作出总结相关工作全同态加密简称由等人在年首次提出若某种加密体制对各种运算都满足同态性质意为密文进行某种运算后进行解密得到的明文恰好是对应明文的运算结果尽管概念简单但全同态加密的设计实现难度很大直到年在其博士论文中基于理想格成功构造出第一个真正意义上的全同态加密体制体制使得该领域得到突破性进展接下来的几年里全同态领域的研究突飞猛进各种全同态加密体制纷纷出现全同态加密体制研究现状目前的全同态加密体制根据基于的数学难题及代数结构不同大致分为以下几类基于理想格的全同态加密体制整数上的全同态加密体制基于问题的全同态加密体制基于环上问题的全同态加密体制基于理想格的全同态加密体制虽然首次实现了全同态加密体制但体制的密文运算计算复杂度过高公钥尺寸过大为了得到性能更好的全同态加密体制以达到高效实用的最终目的全同态加密初期研究的大量成果可归结为体制的优化方案针对体制公钥尺寸过大的问题等人提出优化方案称为体制体制公钥尺寸很小但密钥生成算法复杂度过高借用体制的思想等人给出加密体制的另一种优化方案称为体制体制使用主理想格作基础并使用体制中的公钥形式但对密钥生成过程进行了简化随后等人提出了技术技术本质上是一种并行思想在体制和体制的基础上使用中国剩余定理对明文空间进行分解使得每份密文对应多份相互独立的明文所以利用技术可以减小单位明文对应的密文尺寸更高效地利用空间和计算资源整数上的全同态加密体制年等人提出一种新的全同态加密体制该体制基于整数上近似最大公因子问题称为体制该体制结构简单便于理解但公钥尺寸极大效率较低无法满足实际应用的需求到目前为止等人在文献中构造的体制计算复杂度约为为体制安全参数该体制在此类体制中的优化已达康元基等利用特征向量构造基于身份的全同态加密体制到较好效果此类体制沿用博士论文中设计全同态加密体制的方法以下称方法但基于该方法设计的体制的安全性必须依赖一个额外的假设即稀疏子集合假设简称但该假设的强度缺乏严格证明另外方法需要大量密文同态运算因此使用方法设计的全同态加密体制的计算复杂度很难降低基于问题的全同态加密体制以下简称体制理想格上很多困难问题的难解性并未得到证明因此这类体制在安全性方法上也有一定的隐患年和构造了基于一般格上困难问题的全同态加密体制称为体制体制基于问题与理想格上的体制相比体制使用的问题难解性得到了严格证明并且体制的解密运算计算复杂度低等人又在此基础上提出密钥转换技术实现对密文噪声的精确控制使得体制的计算复杂度极大地降低基于问题的全同态加密体制以下简称体制年等人首先定义了问题问题与问题结构相似因此许多优化方法可以通用于两类体制而且体制相对于体制在很多加密应用中具有优势首先体制在一些实际应用中效率不高例如构造单向函数其次体制中的带噪声乘法可以一次直接得到上个伪随机结果相当于体制中的次乘法再次若使用快速傅立叶变换那么体制中乘法效率会更高最后使用环中理想对应的格时可以用标准嵌入来代替系数嵌入进一步减少密文尺寸目前的体制根据使用的环类别不同而分为两类第类使用的是特殊环其分圆多项式的次数为的方幂由于其结构简单易于理解并且具备上面提到的所有优点故和按照构造基于问题体制的思路构造基于问题的全同态加密体制随后等人又将问题与问题统一起来称为问题并借此构造了一个基于问题的全同态加密体制第类使用的是任意环即分圆多项式的次数可以取任意值特殊环代数结构简单但同时也牺牲了很多性质首先特殊环分布稀疏在同样满足安全性的前提下使用任意环的体制会比使用特殊环的体制效率高最多一倍第二特殊环上的体制无法实现等技术无法进一步提高效率但任意环上的实用算法和分析工具很少仅有等人提出的一些算法和工具故虽然使用任意环效率很高但后续的研究较少基于身份的全同态加密体制年首次提出了基于身份的加密简称体制这是一种不需要证书的公钥加密体制每个用户都拥有唯一的公开身份信息用户公钥由此信息生成所以不需要认证而用户私钥由可信第三方生成由于无须公钥证书所以体制避免了与证书有关的计算和存储可以更有效地管理密钥减小密钥尺寸但直到年可应用于实际的体制设计方法才由等人与等人分别提出文献的方法分别基于双线性映射函数构造和二次剩余假设近年来格上的难题也被应用于构造基于身份加密体制年等人在加密体制的基础上提出了体制并证明了其安全性因此人们自然地想到构造基于身份的全同态加密体制将基于身份加密体制与全同态加密体制相结合利用基于身份加密体制的优势来进一步提高全同态加密体制的效率在研究的初期体制都需要借助运算密钥来实现并非真正意义上的基于身份加密体制如文献年等人在文献中提出了特征向量方法成功地避免运算密钥实现了真正意义上的体制另外也简要给出了在特殊分圆环上该体制的形式预备知识对于正整数定义为集合对于或上的向量定义其范数为范数软件学报为记为比小且与互质的正整数集合为欧拉函数空间定义为为中第个元素空间定义为在研究以分圆数域和理想格构造的加密体制时使用该空间较为方便格基础中的格可定义为的离散加法子群由个线性无关向量的所有整线性组合构成的集合即两组基生成同一个格当且仅当存在一个幺模矩阵使得的行列式与基的选取无关定义为任意一组格基矩阵的行列式如在欧式范数下的第小量定义为格中最短非零向量长度的对偶格定义为容易看出对于定义高斯函数为归一化该函数就可得到连续高斯分布其概率密度为定义对于中任一向量有格陪集和实数可定义上的离散高斯分布为分圆域环性质对于正数数在有理数域中添加次本原单位根得到的域扩张称为次分圆数域的极小多项式定义为次分圆数域其中是中次本原单位根例如故与存在一个自然同构由给出的次数为故可将看作上维向量空间并以作为一组基这组基称为幂基所谓特殊分圆环即只取的幂即为正整数域中有个自同构对于所有保持中元素保持不变将映射为标准映射定义为使用标准映射可以定义中元素的欧式范数对于的欧式范数定义为范数定义为迹函数定义为自同构之和显然对于任意和迹函数满足和对于中任意的分式理想它的对偶定义为很容易可以验证也是一个分式理想且在映射下会变为的对偶格下面介绍分圆环上的张量基在构造本文体制时它相比于幂基生成陷门的效率更高并且更适用于一些快速算法定义如下定义的张量基定义如下若为某个素数的幂那么定义为幂基若有素数幂分解定义其中为的幂基康元基等利用特征向量构造基于身份的全同态加密体制问题定义分布对于秘密和上的一个误差分布那么上的分布中的一个抽样生成方式如下均匀随机地选择选择输出定义假设无法以不可忽视的优势来区分以下两个分布第个是从中独立抽样其中随机选择第个是从中均匀随机地取出同样数量的相互独立的抽样记作假设在加密应用中具有离散误差分布的问题通常更有用我们可以自然地定义一个分布其中为上的离散误差分布那么就是上的元素类似地我们可以修改定义令是区分和均匀地从采样的问题对于很多种类的离散误差分布问题的离散形式的困难性是由问题的连续形式来产生的下面的定理意味着如果在个抽样的情况下是难的那么在同样数目的抽样下也是难的其中误差分布是是一个与互质的整数是任意一个有效的离散化到的方法是上一个任意元素可以随着不同的采样而变化特别地对于得到误差分布记在个抽样的情况下为定理令和是互质整数是任意一个将连续分布变为离散分布的方法是上的任意元素如果问题对于给定某个数目个抽样时是难的那么的变体秘密是抽样自在给定个抽样时也是难的基于身份的全同态加密体制全同态体制分为种算法密钥生成加密解密同态运算前种算法与一般的公钥加密体制类似而同态运算则是对应代数结构上密文的运算具体的定义见文献体制一般分为种算法参数选择私钥提取加密解密算法中生成主公私钥对对于身份提取用户私加解密与普通公钥体制类似使用的密钥为用户公私钥对若一个体制同时也是体制即体制一般分为种算法参数选择私钥提取加密解密同态运算前种算法与相同同态运算算法与体制中的算法相同任意分圆环上使用特征向量的全同态加密体制本节首先给出公钥体制并在此基础上提出任意分圆环上近似特向量全同态加密体制最后结合技术进一步提升该体制的效率公钥体制该体制是针对文献公钥体制的变形该体制可以转变为基于身份的加密体制令为次分圆数环为互质的整数其中使用定义明文空间为中的模数令是上的连续高斯分布是上离散高斯分布体制共分为个部分密钥生成算法令取令令私钥在上均匀随机取令为公钥可以发现加密算法加密时取令得到密文解密算法计算输出明文正确性的讨论见文献关于安全性有如下定理定理若且的是难的公钥体制具备安全性软件学报体制描述选择模数令取的一组好基本文中的好基指这组基构成的矩阵的奇异值较小如第节中提到的张量基首先定义本节中用到的几个函数对于其中是二进制表示的第个比特对于定义以下函数若这些函数的自变量为矩阵意为将矩阵的每一行看作向量进行函数调用体制分为密钥生成算法加密算法解密算法密文运算算法这个部分首先令取令在上均匀随机令为公钥私钥先生成个公钥体制中的密文令矩阵的每一行分别是这些的加密结果则令密文矩阵为为维单位矩阵计算解密时只需一行即可令为的第行计算输出令密文矩阵加密明文加密明文令其中和为个公钥体制中加密的密文与相乘的结果即个该结果模得到明文同态加法为同态乘法为体制正确性与安全性分析正确性解密算法输出为其中表示矩阵的第行表示的第行由于的每一行都是加密得到的加密结果所以的结果就是关于体制的安全性有如下定理定理设系统参数为安全参数的多项式取错误分布为环上高斯分布在假设的前提下体制是安全的证明定理证明采用基于游戏序列的证明方法用来定义攻击者在中的优势即标准的游戏挑战者调用密钥生成算法生成公钥并将其交给攻击者没有访问解密谕示的能力因此选择挑战明文从中随机选择加密生成挑战密文并将其交给攻击者猜测对应明文为攻击者的优势记为康元基等利用特征向量构造基于身份的全同态加密体制与的区别在于公钥的生成方式的公钥直接从中均匀随机取得由文献推论可知公钥与上的均匀分布的统计距离在以内即区分与的概率小于因此在的基础上加密算法被修改密文中的不再是的密文而是从均匀随机抽取由文献引理与假设可知修改前与修改后的是计算不可区分的因此区分与的概率小于的可忽略函数记作因此有在中给出的挑战密文不再由加密算法生成而是直接从生成由知由于此前中已替换为上的随机值因此与上的随机分布计算不可区分即与上的随机分布计算不可区分故有至此在中挑战者所给出的公钥密文都服从均匀分布且与目标密文之间完全独立因此在中能取得的优势为即结合公式公式可得因此在假设成立的情况下可忽略即体制是的安全性得证技术从文献的分析可以看出技术实际是一种并行思想目前技术相继被应用到体制和体制中实现了两种全同态加密体制文献中等人使用了包括技术在内的多种优化效率方法极大地降低了计算复杂度而基于该体制实现的加密算法实验证明该体制在一定程度上已可以应用于实际具体方法是将整个明文空间其中分解为相同大小的子环待加密的明文分别属于这些子环然后将它们合成为对合成明文进行加密即相当于并行加密了子环上的所有明文故使用技术将大幅提升加解密的效率但特殊分圆环不能进行分解故使用特殊分圆环无法使用技术在加密体制中一般都为质数但一般不是质理想接下来讨论对进行理想分解令为满足能整除的最大整数令令为模意义下的乘法逆元由文献知可分解为那么可分解为其中是范数为且两两不同的质理想第节的中明文空间为故可将其如上分解实现并行加密若可分解为个首一不可约多项式就可以同时加密个明文效率分析体制相比体制最大的区别就在于使用任意分圆环来代替特殊分圆环由于特殊分圆环分布稀疏所以在相同安全性条件下使用任意分圆环的计算效率最高可达使用特殊分圆环的两倍这是由于特殊分圆环的分圆多项式为举例来说若取时并不能满足安全性条件故只能取然而在与之间有许多可达到与相同安全性的值例如这样任意分圆环与特殊分圆环的维数相差近乎两倍那么软件学报环上运算的效率会相差至少两倍任意分圆环的另一个优势在于它可以利用中国剩余定理进行划分因此明文空间也可以分割为多份就能支持技术表给出了两种体制在相同安全性条件下的效率分析对比为两种体制的模数安全参数取为分圆多项式次数那么体制中体制中可以看出两种体制的环维数相差接近两倍令两种体制中公钥维数表中乘法与加法均指环上运算但对于体制来说环上运算所占用的空间较少另外体制相比基于问题的体制公钥尺寸也极大地缩小以文献的体制为例在格维数的情况下公钥尺寸将达到从表可看出体制的公钥尺寸仅仅只有表体制效率分析对比加密复杂度次乘次加次乘次加解密复杂度次乘次加次乘次加公钥尺寸私钥尺寸任意分圆环上使用特征向量的基于身份公钥加密体制任意环上的陷门生成本节构造了任意环上的陷门采用文献的思想从整数环上的陷门转化为任意环上的陷门此陷门在接下来构造基于身份的体制时使用对于矩阵定义显然和都是格关于这两个格的基有以下引理引理令定义如下若是的任意一组基是的任意一组基那么是的一组基给定格的一组好基设为维若使用空间中一个点来表示格陪集那么通过前像采样可以得到上的符合离散高斯分布的一系列点采样的方法记作具体流程如下遍历使用基将表示为其中随机从中选取一个元素并令其为输出接下来即可使用上述引理及采样方法进行陷门的构造陷门构造过程共分为步选择矩阵为上均匀随机的矩阵由引理选取的一组好基及的一组好基例如张量基生成的好基作为陷门陷门函数定义为若给出要计算向量首先计算满足等式的特解然后利用陷门进行前像采样求得分布上符合离散高斯分布的向量输出基于身份的公钥加密体制在基于身份的体制中定义随机喻示可将身份映射为公钥使用第节中提出的陷门则任意环上近似特征向量的基于身份加密体制如下康元基等利用特征向量构造基于身份的全同态加密体制参数生成由陷门生成陷门函数令主公钥为也即体制中的公钥主私钥为私钥提取令使用进行前像采样得到用户私钥加密算法使用身份加密明文首先令输出密文解密算法执行体制正确性与安全性分析由第节中关于体制的正确性分析可知体制的正确性同理关于安全性有如下定理定理若体制具备安全性并且其公钥在上均匀地随机分布那么体制在随机喻示模型下是安全的证明若存在一个针对体制的多项式时间攻击者在攻击游戏中优势为不可忽略并且有次喻示访问权限条件那么我们可以构造一个针对体制的攻击者其在攻击游戏中优势为攻击者的输入体制中公钥首先随机选取并模拟攻击游戏模拟随机喻示对于的第次访问若那么保存三元组并将交给若则调用生成公私钥对保存三元组并将交给模拟私钥提取喻示若以身份访问私钥提取喻示不失一般性地假设已经用访问过随机喻示因此只需查询已保存的三元组将交给若那么输出一个随机值并终止模拟挑战密文当生成挑战明文和挑战身份时不失一般性地假设已经用访问过随机喻示若即并未保存过那么输出一个随机值并终止否则向体制攻击游戏的挑战者发起挑战得到挑战密文并将交给当终止并输出结果时也输出同样的结果并终止在模拟过程中没有终止并输出结果的概率为即的概率这时成功模拟出攻击游戏根据假设可知在这种情况下攻击成功的优势为故攻击体制的优势为基于身份的体制向基于身份的全同态体制的转化本节介绍一种将基于的体制并且满足某些性质转化为的方法该方法是文献中转化方法的关于环的变体若一个体制满足以下性质那么都可以使用该方法进行转换对于身份令私钥为对应密文为那么第项为若加密了那么的加密结果与上的均匀分布不可区分定理若一个体制满足上述条性质那么该体制可以转化为一个体制证明使用的参数设置和密钥生成算法并将的主公钥加入中令为加密明文加密者使用的加密算法生成个的加密结果令为的矩阵且它的每一行分别是这些密文输出若为身份对应的私钥那么解密者运行的解密算法来恢复同态运算的讨论与第节中相同令那么由于性质故解密是正确的若存在一个攻击者可以从上述体制中区分和上的均匀矩阵则由性质该攻击者也可以以不可忽略的优势解决即证明了该体制安全性故定理得证显然第节提出的体制满足上面条性质故由上面定理可将体制与第节的体制结合得到一个体制体制本体制以任意分圆环作为基本代数结构因此与体制一样软件学报体制也可实现技术本节利用特征向量构造一个真正意义上的体制相比之下等人提出的体制在实际应用中必须借助公钥证书进行认证而且还需要证书分发管理效率分析与对比与文献提出的体制相比体制以问题作为基础因此密文运算效率较高加解密计算复杂度有很大降低并且密文尺寸更短表给出了与体制在相同安全条件下的效率分析与对比为体制所使用格的维数即或对应的理想格维数格维数都取体制的公钥尺寸分为加密公钥和运算密钥两部分而的公钥尺寸只包含加密公钥故公钥尺寸大大缩小另外由于体制可使用技术加解密效率可进一步提高由第节的分析理想可分解为个质理想的加密时最多可以同时加密份明文故的加解密效率还可提高为倍体制的私钥是整数上向量的私钥是环上向量故私钥尺寸有所增加与中基于身份的全同态体制相比由于中体制所使用的基础结构是特殊分圆环因此要达到同等安全条件体制的维数至少要取公钥尺寸就会变大相比本文体制大了另外同样无法使用技术表总体制加密复杂度次乘次加次乘次加次乘次加效率分析对比解密复杂度次乘次加次乘次加次乘次加公钥尺寸私钥尺寸是否可使用技术否否是结在云计算的背景下全同态加密有着广阔的应用前景但效率低下的问题一直制约着全同态加密在实际中的应用因此本文先给出基本的公钥体制和一种陷门生成算法然后针对全同态加密体制效率低下的问题结合近似特征向量方法和技术使用任意分圆环提出了一个体制相比已有的体制效率大大提升康元基等利用特征向量构造基于身份的全同态加密体制附中文参考文献光焱顾纯祥祝跃飞郑永辉费金龙利用容错学习问题构造基于身份的全同态加密体制通信学报康元基男辽宁凤城人主要研究郑永辉男博士讲师主要研究领域为全同态加密技术领域为密码学顾纯祥男博士副教授主要研光焱男博士讲师主要研究领究领域为密码学域为密码学网络信息安全