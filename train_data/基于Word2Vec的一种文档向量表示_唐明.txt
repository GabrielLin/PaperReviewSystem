第卷第期年月计算机科学基于的一种文档向量表示唐明朱磊邹显春西南大学计算机与信息科学学院重庆摘要在文本分类中如何运用词向量高效地表达一篇文档一直是一个难点目前将模型与聚类算法结合形成的模型能有效地表达文档信息但是这种方法很少考虑单个词对整篇文档的影响力为了解决这个问题利用算法计算每篇文档中词的权重并结合词向量生成文档向量最后将其应用于中文文档分类在搜狗中文语料库上的实验验证了新方法的有效性关键词文本分类中图法分类号文献标识码引言目前使用最广泛的文档表示方法几乎都基于词袋法词袋法将文档看成是一些词的集的值为但是我们知道土豆与马铃薯是同一种食物词袋法很难区分同一个词在不同语境中的意义如先生根据上下文它可能是对男性的称呼也可能是古代对老师的称呼但在词袋法中其文档向量计算相似度为合在该集合中每个词的出现是相互独立的且不考虑词的随着深度学习的发展基于神经网络的自特征抽取顺序语法和语义等信息它将一篇文档表示成与训练词汇的词向量表示方法越来越受工业界和学术界的关注基于前集合相同维度的向量向量中每个位置的值即是该位置所代人的研究等人在年提出了模型表的词在文档中出现的次数并且随着新词汇的增加文档向用于计算词向量即下文的后面量维度也会增加虽然词袋法在传统分类器上的分类效果不均简称为词向量模型利用词的上下文信息将一错比如目前比较成熟的分类技术回归模型最近邻分类个词转化成一个低维实数向量越相似的词在向量空间中越贝叶斯分类决策树神经网络支持向量机相近将词向量应用于自然语言处理非常成功已经被广泛等但它依旧存在几个主要问题维度太高文应用于中文分词情感分类句本向量的维数与训练数据集中出现的所有单词的数目一样法依存分析等多这样容易出现所谓的维度灾难现象而且如果某一个词然而一篇文档由无数词构成如何利用词向量有效地表汇在训练集中没有出现过则该词汇在测试集中出现时就无示一篇文档是当前的一个难点目前在这方面的研究进展缓法成为该文本的特征一篇普通文档只有个词左右慢常见的方法有对一篇文档所包含的所有词向量求平均而词向量的维度却能达到万利用率仅为所以基于值对词向量聚类以及模型但这些方法表示的文档向量非常稀疏不利于一些自然语言处理任并未重视单个词对整个文档的影响力针对这个问题本文务词袋法无法很好地表示一篇文档的语义它假设词与词在的基础上利用算法对每篇文档中的之间相互独立并不考虑词与词之间的关系如土豆与马分词进行加权并在搜狗中文实验语料库上进行测试测试结铃薯这两个词在用词袋法所表示的文档向量计算相似度时果验证了该方法的有效性到稿日期返修日期唐明朱磊男硕士生主要研究方向为男硕士工程师主要研究方向为数据挖掘机器学习邹显春男硕士副教授主要研究方向为数据挖掘机器学习树在这棵树中叶子节点共相关工作个分别对应词典中的词非叶子节点个通过随机词的向量化梯度上升算法对的结果进行预测使得词的向量化就是将语言中的词进行数学化也即把一个词表示成一个向量词的向量化主要有以下种表达方式方式值最大化指词的上下文中的个词当神经网络训练完成时即可求出所有词的词向量有趣的是当利用词向量表示一个词时可以发现类似这样的这是一种最简单的方式用一个很长的向量来表示一个规律可以看出词词向量的长度为词典的大小通常达到向量的分量向量非常有利于表达词的语义特征只有一个其余全为的位置对应该词在词典中的位置文档的向量化比如土豆表示为模型而马铃薯表示为文档的向量化就是将一篇文档表示为一个向量主要是这种方式虽然可以简单明了地表达一个词语但是却无法有效表达它们的语义信息土豆和马铃薯虽然是同一种食物但利用常规的向量距离公式比如欧几里德距离或者余弦距离公式都无法有效计算它们的相似度显然这种方式不能很好地表达词之间的相似性词向量这种方式能很好地克服方式的缺点最早由提出它是将词映射到一个低维稠密的实数向量空间中空间大小一般为或者使得词义越相近的词在空间的距离越近上面的例子可以类似地表达如土豆可以表示为下而马铃薯为基于词的向量化将文档向量化之后就可以利用常规的距离向量公式比较两篇文档之间的相似度传统的可以看作是词的表示向量的叠加比如节中土豆的词向量为马铃薯的词向量为而一篇仅包含土豆和马铃薯这两个词的文本就可以表示为显然这种表达方式存在的问题与一样由于其特征向量的高维性和稀疏性很难利用常规的向量距离公式有效地计算两篇文档之间的相似度当然传统的也有许多优化的方法利用加权是其中一种即将文本向量中显然这种表示方式有利于使用距离向量公式比出现非的值替换为权值这样的特征向量比传统较词向量之间的相似度在文本分类方面更有效模型训练词向量通过借鉴提出的模型以及的等提出了语言模型可以快速有效地模型模型的训练与模型类似在利用词的上下文对当前词进行预测的训练过程中添加了一个文档特征向量其预测模型和训练过程分别如图和图所示训练词向量模型有两种分别是模型见图以及前后模型见图其中模型利用词各这里个词去预测当前词而模型恰好相反它利用词去预测它前后各个词图预测模型图模型图模型由于模型的训练和模型的训练类似这里仅介绍模型的训练过程其中输入层是词图的训练过程的上下文中的个词向量而投影层向量是这个词向从图可以看出该模型是利用前几个词去预测当前量的累加和输出层是以训练语料库中出现过的词作叶子节的词比如用我喜欢吃苹果这个句子中的前个点以各词在语料库中出现的次数作为权值构造出的一棵词去预测第个词而且在训练过程中添加了一个文档特征向量其余部分与预测模型类似可以将该文档特征向量看作是一个表示当前文档中的其余部分信息或者主题信息的向量通常根据文档特征向量的维度不同将该文档的特征向量与词向量相结合的方法包括取平均值和串联两种方式图中的训练过程是利用串联的方式对文档向量进行训练其中代表文档向量代表词向量代表隐含层权值类似代表输出层的值与中的每一维即代表词典中的一个词和分别代表它们之间的连接矩阵其训练过程与模型类似并利用算法调节参数的方法基于图文本分类的工作流程目前基于的文档表示方法主要是一些聚类的方法或者取平均值的方法而表现较优的是模型因为它在训练的时候加入了表达文档的特征向量所以用于文实验文本分类模型评估档分类等任务时一般表现比好综合考虑词的向量化方式和文档的向量化方法结合采用的评估指标包括准确率召回率指标以及宏平和算法提出了一种基于的文档均其中准确率是指文本分类正确的样本数与所有分类向量表示方法文本数的比例如果则基于算法的改进方法在词向量的基础上结合算法提出了文档向量的表示方法与结合对于包含个文档的集合其中已经采用分词工具对中文文档进行分词将其通过模型训练得到每个分词对应的维词向量其中对于每类文档集中的每个文档里的每个分词利用算法计算其在该文档中的权重值其表示为词在文档中的权重综合考虑了词召回率是文本分类正确的样本数与该类的实际文本数的比例如果则样本数是属于该类但未被区分出来的样本数指标是将准确率与召回率同时考虑的一种指标评估宏平均是对所有类别的以及的平均值用来评重实验结果与实验分析实验选用的测试数据是搜狗实验室的中文文本分类语料其中为训练文档的总数为训练文档集中出现词的文档数库共包含文本篇分为类分别是财经健康体育旅游教育招聘文化和军事其中每类有篇文本在预处理过程采用分词工具对文本进行分词的计算公式如下准确率召回率以及是对单独类别的分类性能进行估系统的总体分类性能其中是分类正确的样本数据是错误地划分到该类别的在单个文档中出现的概率以及该词在整个文档集中的权词的计算公式如下去掉标点符号停用词助词等后得到词条个槡将提出的加权的模型与加权的模型即将向量中分词相应位置的值替换成其中为词在第篇文档中的词频分母为归一化权值均值模型以及模型的分类因子效果进行对比其中分类器分别采用了对于每篇文档其文档向量可以表示为如下形式以及神经网络加权的模型在构建词向量时特征提取采用了文档频率选择与信息增益选择结合其中表示分词的词向量所以文档向量也是一个的方法且将词条在整个所属类别文本中出现次数为以下维的实数向量的过滤掉最终只选取了个词条来构建词向量均值文本分类的工作流程模型是对一篇文本计算其所有所得词向对未知文档的分类过程如图所示由于对于单篇未知量的均值其中以及的计算采用的文档单独计算其值并无意义因此在计算其开源软件实现所有实验采用五分交叉验证即把数据集值时值如果是新词则取依然选取该分词在随机划分成份每次取其中份进行训练份进行测试训练阶段的值然后把次分类结果的平均值作为最终结果测试结果用正确率指标进行评测测试结果如表表召回率分别代所列其中类别可以看出均值模型所生成以及表财经类类健康类体育类旅游类教育类招聘类文的词向量比传统的所生成的词向量能更有效地表示一化类以及军事类代表的宏平均值篇文档的特征而本文提出的基于加权的模型相比均值模型又有一些提升在表加权模型类别以及分类器上宏平均正确率分别提升了而宏平均分别提升了以及以及宏平均召回率分别提升了以及宏平均分别提升了以及而加权的模型与模型的宏平均值效果相差不大在几组分类器上的效果相当可见提出的方法的有效性其可以作为另外一种用于文档分类的有效方法由图也可以清楚地看出无论采用何种分类器基于模型在宏平均上均有不错的表现加权的验证了所提出的生成文档向量的方法在文档分类方面的有效性表均值模型类别图种文档向量分类效果比较结束语针对当前文本向量表示方法的不足借助的优点将和结合提出了一种表模型类别基于的加权计算文档向量算法在搜狗中文实验语料库上的实验表明相较于加权的模型以及均值模型本算法有更好的文本分类效果参考文献表加权类别由表表可以发现均值模型在以及分类器上的宏平均准确率召回率以及值比加权模型的有不少的提升比如宏平均正确率在分类器上由提升到了在另外个分类器上也分别提升了和宏平均召回率在以及分类器上分别提升了下转第页周世兵徐振源唐旭清新的均值算法最佳聚类数确定方法计算机工程与应用谢小璐李磊区间数信息下的多属性群决策研究计算机工程于剑程乾生模糊聚类方法中的最佳聚类数的搜索范围中国科学辑卢志茂冯进玫范冬梅等面向大数据处理的划分聚类新方法系统工程与电子技术上接第页搜狗文本分类语料库