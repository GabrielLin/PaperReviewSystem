研究与开发基于深度信念网络和线性单分类的高维异常检测李昊奇应娜郭春生王金华杭州电子科技大学浙江杭州摘要针对目前高维数据异常检测存在的困难提出一种基于深度信念网络和线性单分类支持向量机的高维异常检测算法该算法首先利用深度信念网络具有良好的特征提取功能实现高维数据的降维然后基于线性核函数的单分类支持向量机实现异常检测选取机器学习库中的高维数据集进行实验结果表明该算法在检测正确率和计算复杂度上均有明显优势与算法相比检测正确率有的提升与自动编码器算法相比其训练和测试时间均有显著下降关键词异常检测高维数据深度信念网络单分类支持向量机中图分类号文献标识码常数据是指在数据集中偏离大部分数据或者与数引言据集中其他大部分数据不服从相同统计模型的小异常检测是数据挖掘中的重要组成部分异部分数据而异常检测就是要识别出异常数据收稿日期修回日期基金项目国家自然科学基金资助项目电子科学与技术浙江省一流学科类基金资助项目电信科学年第期从而消除不符合预期行为的模式问题异常检测法局部线性在信用卡欺诈网络入侵健康医疗监控等诸多嵌入法和典型生活领域中均有重要应用相关分析在异常检测中单分类支持向量机是常用的有效法等在特征提取和数据降维方面有着广泛的应用但这些降维方法均属于线性降维只能提取数据间手段是对二分类支持向量机的一种细的线性关系从而导致在处理高维数据时存在着统化是在异常检测领域中的重要经典算法当确计特性的渐进性难以实现算法顽健性低等问题定合适的参数配置时对于异常数据的尽管对和基于核函数改进后的核主成分检测可以提供良好的泛化能力在中分析法有两种经典算法用于异常检测分别为基于超平和核典型相关分析面支持向量机法可以解决非线性降维的问题和基于超球面的支持向量描述但算法的复杂度较高效率较低法相比对于解决高维的异常检测问题近几年有多种较而言利用超球面分类的算法性能优于经典的方法被提出参考文献直接提出了基于算法因此通常采用算法进中的经典算法即基于超球面的支持向量行异常检测数据描述法该算法虽然对当时的高维数据异常检然而随着互联网的快速发展和物联网的逐测起了很大的推动作用但算法的正确率偏低参渐普及数据的收集更加容易这导致数据库的考文献将算法和相结合将数据规模和数据的复杂性急剧增加从而产生大量的利用经典的线性降维方法进行降维在高维数据如证券交易数据用户数据网中采用非线性核函数进行异常检测由于络多媒体数据等维度的迅速增长使得传统的线性降维的局限性其结果并没有很大的提升参方法对高维数据的异常检测效率逐渐下考文献利用改进后的算法和进降从而导致高维数据的异常检测成为数据挖掘行异常检测检测结果虽有所提升但由于非线性的难点核函数计算量大对数据进行训练和测试所需要的高维数据存在的普遍性使得对高维数据挖掘时间较长导致该算法的效率不高参考文献的研究有着非常重要的意义但维度灾难问利用自动编码器通过对比不题导致对高维数据挖掘变得异常困难即在分析同数据间的重构误差进行异常检测其识别率虽有高维数据时所需的空间样本数会随维数的增加所提升但测试效率依然不高而呈指数倍增长对于高维数据的处理传统的本文提出利用深度信念网络多元统计分析方法存在很多的局限性同时高维进行数据降维再利用基于线性数据空间中的稀疏性使得采用非参数方法的大样核函数的单分类支持向量机这种组合模型实现异本理论也并不适用因此采用数据降维是处理常检测深度信念网络本质上是一种概率生成模高维数据的最主要的高效手段型通过无监督的训练方法由底层至顶层逐层训在机器学习领域中所谓降维就是指采用某种练而成与其他传统的线性降维方法相比深度映射方法将原高维空间中的点映射到新的低维空信念网络最大的特点就是利用其自身非线性的结间中经典的数据降维方法如主成分分析构进行特征提取将数据从高维空间映射至低维研究与开发空间从而降低数据的维度这种非线性降维方在中使用算法进行异常检法可以在最大程度上保留原始数据的高维特征测为无监督训练算法与有监督的二分并且算法的复杂度较低相比于其他算法可以更类相比它并不是要寻找能够区分数据的最有效地解决高维数据的异常检测问题实验结果优超平面而是寻找能够包含大多数正常数据的表明本文提出的混合算法模型即将深度信念最优超球面如图所示当输入空间的数据不网络和线性单分类支持向量机组合在一起解决高可分时构造一个映射函数将输入空间中的数维数据的异常检测问题在检测正确率和测试效据映射到特征空间中在特征空间中寻找支持率上都有很大提升向量构造一个将绝大多数点包围在其中并具有最小半径的最优超球面由支持向量确定的超球面算法设计即正常数据类的描述模型超球面外的点被判断本文所提出的算法模型如图为离群类数据点即异常数据所示该模型由两部分组成即底层的和顶层在的核函数选取中选择线性函数代的由个限制玻尔兹曼机替传统方法中的径向基函数堆叠而成将原始数据在中核函数的选择对算法的性能起首先输入的输入层经训练后输入层着重要的作用利用核函数可以将线性不可分的输数据被映射至隐藏层隐藏层的输出作为入空间映射到更高维的特征空间从而将正常数据的输入继续训练后得到隐藏层隐藏层的数据即和异常数据进行完全分离通常相比较线性核函的输出并将其输入中进行异常检测数而言等非线性核函数可以将数据映射到更适于线性分类的特征空间从而提高的分类性能但利用本文提出的模型经进行降维以及特征提取后的数据通过线性核函数依然可以进行优秀的分类从而规避了线性核函数的缺点反而突出了其优点即降低了算法的时间复杂度和空间复杂度提高了系统的运行速率算法原理图基于深度信念网络的高度降维的实质是由一个高斯伯努利型结构图算法示意年第期电信科学作为底层上层接有多个伯努利伯努利型的联合概率密度为这样将多个堆叠起来便得到了所需要的生成模型将第一个训练后得到的输出作为下一个的输入继续训练如此往复经过训练后的各个参数就是的初其中始化参数配分函数为正规化因子把称为限制玻尔兹曼机是玻尔兹曼机目的是要找到的势能最低点使的一个特例其本质上是由一层可见层达到稳态即通过训练优化的各项参数使神经元和一层隐藏层神经元所构成的双层无向神达到最小值而经网络模型同时可见层和隐藏层的各自每层网络之间的神经元是无连接的二者构成一个二分图对于给定的样本数为维数为的集合经过深度信念网络后得到样本数为维数为的集合由于从而达到数据降维的目的对于每一个都有一个能力值与其对因此可以得出的最小值即的最小值采用随机梯度下降算法来极小化的负对数似然度应设可见层向量为隐藏层向量为当可在中负对数似然度对于任意一个模型见层神经元和隐藏层神经元取二进制值并服从伯努利分布时即此时的参数的导数为为伯努利伯努利型其能量函数为其中为某个模型参数其等价于和分别是从数据和模型中估计的的期望值对于可见其中和分别为可见层向量和隐藏层向层隐藏层神经元的权重有量的第个和第个神经元为连接可见层单元和隐藏层单元的权重矩阵为其中第行第列的元素和分别为可见层和隐藏层的由于偏置向量和为相应的第个和第个偏置这一项很难得到精确的计算采用对比散度算法估单元当可见层单元取实数值即并服从高斯分布时此时的为高斯伯努利型对于每一个配置其能量函数为计此项该算法利用步吉布斯采样后得到的近似代表项的值通常则式可以转化为根据该能量配置函数设定可见层和隐藏层其中代表算法迭代次的平均值在研究与开发一个训练好后可以将另一个堆叠在通过求解上述问题可以得出其上层并将第一个的隐藏层向量作为下一拉格朗日乘子数据在超球面个的可见层单元继续训练底层的为内部为非异常数据高斯伯努利型由于其输出为二进制数则上层的均为伯努利伯努利型由多个堆叠而成堆叠的多个可以看作不同层的非线性特征提取器随着层数的递增提取的特征更加抽象更能代表高维数据中愈渐复杂的统计结构因此用进行数据降维的效果数据在超球面边界上为非异常数据数据在超球面外部为异常数据实验与分析要远远优于其他传统方法实验中将算法与算法基于单分类支持向量机的异常检测对于经降维后的数据将其输入进行异常检测在中采用算法对降维后的数据进行异常检测对于给定的输入数据可以找到一个紧致的超球面来尽可能地包含绝大部分数据点在超球面以外的数据点则被认定为异常数据超球面的中心表示为为其半径则进行异常检测便转化为优化以下二次规划问题算法和算法进行比较从检测正确率和训练以及测试时间方面对比种算法的性能本实验采用的数据集来自机器学习库数据均采集于真实的生活共选取个高维数据集进行训练和测试其分别为森林覆盖集基于传感器检测的气体种类集日常活动集和基于智能设备穿戴的人类活动集其维数分别为和维采用不同维度的数据集进行测试从而更好地评估本文算法性能对于每个数据集分别将其中的用来训其中是将数据映射到较高维空间的非线性练即作为训练集将其余数据的用作测试集函数为正则化参数用来调整超平面的大小在训练集中混入的异常数据测试集中混入权衡球面内外数据点的分布避免出现过拟合的异常数据异常数据的每一维由均匀分布和是松弛变量允许一些数据点位于超随机生成实验前将数据进行预处理对球面外部令于每一个维度的数据统一归一化至数据的类据由于种算法均采用无监督训练数据的类别则上述问题便可以转化为别标签分为两种代表正常数据代表异常数标签只在测试时使用对于算法选取的贡献率来确定降维后的数据维度对于算法根据参考文献设定重构误差的异常阈值在以下实验中用后所加的数字表示的层数例如和分别表示为具有层和层隐藏层的深度信念网络在实验一电信科学表年第期种算法在核函数下的异常检测正确率数据集算法模型平均值表种算法在线性核函数下的异常检测正确率数据集算法模型平均值和实验二中默认的为具有层隐藏层的深度信念网络对于的每个隐藏层神经元个数根据参考文献的方法在最优性能下确定在中采用交叉验证法对数据进行训练交叉训练重数设定为的参数选取采用网格搜索法在规定的参数范围内寻找最优解其参数范围分别为系数惩罚参数图实验一算法下两种核函数的异常检测正确率对比通过观察表表中的数据以及图图将算法与可以得出以下结论两种经典算法分别在线性核函数和径向基通过比较个数据集异常检测正确率的平函数下进行实验对比均值可以得出种模型算法的对比结果通过对以上个数据集进行异常检测其识别率见为表表识别率保留百分号前小数点后两位其中线性的检测正确率最并将表表的数据绘制成图图的折线高为相比于和的和的检测结果分别有和的提升对于方法降维当使用线性核函数时对于低维数据集如异常检测的正确率有一定提升当数据维度较高时如利用降维相比于图函数下种算法对个数据集的异常检测正确率算法其测试结果几乎没有提升研究与开发对于和这两种算法无算法通过对比数据间的重构误差在异常检测正论使用线性核函数或者径向基函数随着确率上也可以达到很好的效果再将两种算法的训练数据维度的增加其异常检测的正确率逐和测试时间进行对比实验结果分别见表和表渐下降而使用算法其异常检由表可以看出算法下两种核测结果基本不受数据维度的影响在各种函数分别进行训练的时间基本一致这也进一步维度的数据中其检测结果都要优于另外表明对高维数据进行特征提取的优良特性两种算法对于算法其训练时间平均为分别对于算法当使用线性核函数为线性核的倍和核的倍进一步说明了算法的高效性和径向基函数时对实验结果基本不产生影响这说明利用更好地提取了高维由表可以看出算法的测试时间平均时数据中的特征即使用线性核函数也有很间为均大于线性核和好的检测结果核算法与算法相比线性核函实验二数的测试平均时间为时间缩短了近将算法与算法分别在检测正倍核函数的测试平均时间为确率和检测效率上进行比较对于混时间缩短了近倍对于算法其合模型训练和测试的时间包括数据降维部分和采用线性核函数所测试的时间小于采用核函降维后异常检测两部分的总和训练和测试的时数进行测试的时间这是由于核函数具有更间为平均迭代次的时间值高的计算复杂度因此需要花费更多的时间由首先将分别在线性和两种核于采用线性核函数和核函数异常检测正确函数下的异常检测率与算法进行比较实验率几乎一致而采用线性核函数进行测试的平均结果见表时间为相比于采用核函数的由表可以看出算法的平均异常检测正时间降低了因此采用线性核函数在很确率为与算法在核下的大程度上缩短了进行数据测试的时间提高异常以及线性核下的几乎没有差别说明检测效率表与算法的异常检测正确率对比数据集核函数算法模型线性平均值表与算法的训练时间对比单位数据集核函数算法模型线性平均值电信科学年第期表与算法的测试时间对比单位数据集核函数算法模型线性平均值表线性核函数下不同隐藏层数对实验结果的影响算法模型数据集平均值实验三在确定混合模型为最优算法的前提下探究隐藏层的层数对实验结果的影响由于过多的层数会增加模型的复杂性和算法计算量因此只讨论最多层隐藏层对实验结果的影响在实验中进行了具有层图不同隐藏层数下的异常检测正确率隐藏层的测试接下再分别对和在线性核函数下进行实验测试实验结果数据降维的方式该算法很好地解决了高维数据的异常检测问题利用的非线性特性以及逐见表将表中的实验结果绘制成图后可以看出具有层隐藏层的属于浅层模型导致其最终实验测试结果除了在数据集为略高于其他两种算法外在其余数据集的测试结果均低于另外两种深层模型对于其实验结果与相比除了在数据集上有较大波动外检测率降低了在其他数据集上的检测结果相差甚微只在范围波动基本相同而对于层递进的特征提取方式来获得高维数据中的低维特征良好地解决了维数灾难问题通过实验确定了为最佳的降维网络模型采用线性核的算法在测试时间上相比核可以降低对比算法其检测正确率最高提升了对比算法其测试时间缩短到参考文献王忠伟陈叶芳肖四友等一种高维大数据全近邻查询而言其网络模型的复杂度以及计算量均高于算法电信科学因此确定具有层隐藏层的为最佳网络模型结束语本文通过将深度信念网络和单分类支持向量机组合到一起提出算法模型通过研究与开发李昕钱旭王自强一种高效的高维异常数据挖掘算法计算机工程作者简介李昊奇男杭州电子科技大学硕士生主要研究方向为深度学习与数据挖掘程辉方景龙王大全等超平面支持向量机简化性能分析电信科学应娜女博士杭州电子科技大学副教授硕士生导师主要研究方向为信号处理与人工智能郭春生男博士杭州电子科技大学副教授硕士生导师主要研究方向为模式识别与人工智能王金华女杭州电子科技大学硕士生主要研究方向为深度学习与自然语言处理